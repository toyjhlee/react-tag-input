(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?module.exports=factory(require("react")):typeof define==="function"&&define.amd?define(["react"],factory):(global=global||self,global.ReactTagInput=factory(global.React))})(this,function(React){"use strict";React=React&&Object.prototype.hasOwnProperty.call(React,"default")?React["default"]:React;var classSelectors={wrapper:"react-tag-input",input:"react-tag-input__input",tag:"react-tag-input__tag",tagContent:"react-tag-input__tag__content",tagRemove:"react-tag-input__tag__remove",tagRemoveReadOnly:"react-tag-input__tag__remove-readonly"};function removeLineBreaks(value){return value.replace(/(\r\n|\n|\r)/gm,"")}var htmlEntityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function escapeHtml(value){return String(value).replace(/[&<>"'`=\/]/g,function(s){return htmlEntityMap[s]})}function safeHtmlString(value){return escapeHtml(removeLineBreaks(value))}var __extends=undefined&&undefined.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var ContentEditable=function(_super){__extends(ContentEditable,_super);function ContentEditable(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.focused=false;_this.removed=false;_this.preFocusedValue="";_this.regSpecialCharacter=/[^ㄱ-ㅎ|가-힣|a-z|A-Z|0-9|\*]/g;_this.onPaste=function(e){e.preventDefault();var text=e.clipboardData.getData("text/plain");document.execCommand("insertHTML",false,safeHtmlString(text))};_this.onFocus=function(){_this.preFocusedValue=_this.getValue();_this.focused=true};_this.onBlur=function(){_this.focused=false;var ref=_this.props.innerEditableRef.current;var _a=_this.props,validator=_a.validator,change=_a.change,maxLength=_a.maxLength;if(!_this.removed&&ref){if(ref.innerText===""){_this.props.remove();return}if(validator){var valid=validator(_this.getValue());if(!valid){ref.innerText=_this.preFocusedValue;return}}change(_this.finishConvert(ref.innerText))}};_this.finishConvert=function(origin){var _a=_this.props,maxLength=_a.maxLength,spaceRemove=_a.spaceRemove;var input=origin;if(spaceRemove){input=input.replace(/\s/g,"")}if(maxLength){input=input.slice(0,maxLength)}return input};_this.onKeyDown=function(e){if(e.keyCode===13){e.preventDefault();_this.focusInputRef();return}var _a=_this.props,removeOnBackspace=_a.removeOnBackspace,maxLength=_a.maxLength;var value=_this.getValue();if(removeOnBackspace&&e.keyCode===8&&value===""){_this.removed=true;_this.props.remove();_this.focusInputRef();return}var overMaxLength=maxLength&&_this.getValue().trim().length>=maxLength;if((e.ctrlKey||e.metaKey)&&e.keyCode===86){if(overMaxLength){e.preventDefault();return}}if(overMaxLength&&!_this.isAllowedKeyCode(e)){e.preventDefault();return}if(!_this.hasSpecialCharacter(e)&&!_this.isAllowedKeyCode(e)){e.preventDefault();return}};_this.hasSpecialCharacter=function(e){var inputChar=String.fromCharCode(e.keyCode);var ret=false;if(inputChar===""&&inputChar==null){ret=false}else{if(inputChar.replace(_this.regSpecialCharacter,"")===""){ret=false}else{ret=true}}return ret};_this.isAllowedKeyCode=function(e){return e.keyCode===8||e.keyCode===38||e.keyCode===39||e.keyCode===37||e.keyCode===40||e.ctrlKey||e.metaKey};_this.getValue=function(){var ref=_this.getRef();return ref?ref.innerText:""};_this.getRef=function(){return _this.props.innerEditableRef.current};_this.focusInputRef=function(){var inputRef=_this.props.inputRef;if(inputRef&&inputRef.current){inputRef.current.focus()}};return _this}ContentEditable.prototype.componentDidMount=function(){this.preFocusedValue=this.getValue()};ContentEditable.prototype.render=function(){var _a=this.props,value=_a.value,className=_a.className,innerEditableRef=_a.innerEditableRef;return React.createElement("div",{ref:innerEditableRef,className:className,contentEditable:true,onPaste:this.onPaste,onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.onKeyDown,dangerouslySetInnerHTML:{__html:safeHtmlString(value)}})};return ContentEditable}(React.Component);var __extends$1=undefined&&undefined.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Tag=function(_super){__extends$1(Tag,_super);function Tag(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.innerEditableRef=React.createRef();_this.remove=function(){return _this.props.remove(_this.props.index)};return _this}Tag.prototype.render=function(){var _a=this.props,value=_a.value,index=_a.index,editable=_a.editable,inputRef=_a.inputRef,validator=_a.validator,update=_a.update,readOnly=_a.readOnly,removeOnBackspace=_a.removeOnBackspace,maxLength=_a.maxLength,spaceRemove=_a.spaceRemove;var tagRemoveClass=!readOnly?classSelectors.tagRemove:classSelectors.tagRemove+" "+classSelectors.tagRemoveReadOnly;return React.createElement("div",{className:classSelectors.tag},!editable&&React.createElement("div",{className:classSelectors.tagContent},value),editable&&React.createElement(ContentEditable,{value:value,inputRef:inputRef,innerEditableRef:this.innerEditableRef,className:classSelectors.tagContent,change:function(newValue){return update(index,newValue)},remove:this.remove,validator:validator,removeOnBackspace:removeOnBackspace,maxLength:maxLength,spaceRemove:spaceRemove}),React.createElement("div",{className:tagRemoveClass,onClick:this.remove}))};return Tag}(React.Component);var __extends$2=undefined&&undefined.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var __spreadArrays=undefined&&undefined.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};var ReactTagInput=function(_super){__extends$2(ReactTagInput,_super);function ReactTagInput(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.state={input:""};_this.inputRef=React.createRef();_this.onInputChange=function(e){var input=e.target.value;if(input!==""&&!/^[ㄱ-ㅎ|가-힣|a-z|A-Z|0-9|\*]+$/.test(input)){e.stopPropagation();return}_this.setState({input:input})};_this.onInputKeyDown=function(e){var input=_this.state.input;var _a=_this.props,validator=_a.validator,removeOnBackspace=_a.removeOnBackspace,spaceRemove=_a.spaceRemove;if(e.keyCode===13){e.preventDefault();if(input===""){return}var valid=validator!==undefined?validator(input):true;if(!valid){return}if(spaceRemove){_this.addTag(input.replace(/\s/g,""))}else{_this.addTag(input)}}else if(removeOnBackspace&&(e.keyCode===8||e.keyCode===46)){if(input!==""){return}_this.removeTag(_this.props.tags.length-1)}};_this.addTag=function(value){var tags=__spreadArrays(_this.props.tags);if(!tags.includes(value)){tags.push(value);_this.props.onChange(tags)}_this.setState({input:""})};_this.removeTag=function(i){var tags=__spreadArrays(_this.props.tags);tags.splice(i,1);_this.props.onChange(tags)};_this.updateTag=function(i,value){var tags=__spreadArrays(_this.props.tags);var numOccurencesOfValue=tags.reduce(function(prev,currentValue,index){return prev+(currentValue===value&&index!==i?1:0)},0);if(numOccurencesOfValue>0){tags.splice(i,1)}else{tags[i]=value}_this.props.onChange(tags)};return _this}ReactTagInput.prototype.render=function(){var _this=this;var input=this.state.input;var _a=this.props,tags=_a.tags,placeholder=_a.placeholder,maxTags=_a.maxTags,editable=_a.editable,readOnly=_a.readOnly,validator=_a.validator,removeOnBackspace=_a.removeOnBackspace,maxLength=_a.maxLength,spaceRemove=_a.spaceRemove;var maxTagsReached=maxTags!==undefined?tags.length>=maxTags:false;var isEditable=readOnly?false:editable||false;var showInput=!readOnly&&!maxTagsReached;return React.createElement("div",{className:classSelectors.wrapper},tags.map(function(tag,i){return React.createElement(Tag,{key:i,value:tag,index:i,editable:isEditable,readOnly:readOnly||false,inputRef:_this.inputRef,update:_this.updateTag,remove:_this.removeTag,validator:validator,removeOnBackspace:removeOnBackspace,maxLength:maxLength,spaceRemove:spaceRemove})}),showInput&&React.createElement("input",{ref:this.inputRef,value:input,className:classSelectors.input,placeholder:placeholder||"Type and press enter",onChange:this.onInputChange,onKeyDown:this.onInputKeyDown,maxLength:maxLength}))};return ReactTagInput}(React.Component);return ReactTagInput});
//# sourceMappingURL=true